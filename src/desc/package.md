# Пакеты

## Описание

**Пакет** (Package) - набор данных, поступающих на обработку в соответствующий [узел][4].

Список пакетов отображается в [панели узла][1] в вкладке <span class='iconify-inline' data-icon='mdi:package'></span> [**Пакеты**][2].

Общее количество пакетов в узле в текущем [слое данных][3] отображается в виде ярлыка <span class='iconify-inline' data-icon='ph:number-circle-three-fill' style="color: green"></span>:

![Node packages count](/images/common/node_compute_packages.png)

Количество пакетов в узле в текущем [слое данных][3] без дочерних [заданий][9] отображается в виде ярлыка <span class='iconify-inline' data-icon='ph:number-circle-one-fill' style="color: orange"></span>:

![Node packages count](/images/common/node_compute_packages_no_jobs.png)

**Мастер пакет** (Master package) <span class='iconify-inline' data-icon='fluent:rectangle-landscape-16-filled' style="color: red"></span> - выбранный пользователем корневой пакет слоя данных. Выбор такого пакета позволяет отображать в текущем [слое данных][3] только родительские и дочерние пакеты мастер пакета.

![Master package](/images/common/node_panel_packages_master.png)

## Состав

- Метка - имя
- Поля - переменные простых типов
  > Представление в [JSON](https://www.json.org/json-en.html) формате.Такие переменные можно использовать в запросах логического узла.
- Файлы - объектные переменные или файлы
  > Представление в объектном виде (hdf5, plotly, markdown). При автоматическом создании используется [HDF5](https://portal.hdfgroup.org/display/HDF5/Introduction+to+HDF5) формат.
- Массив пакетов - массив "вложенных" пакетов. "Вложенный" пакет представляет собой обычный пакет с дополнительной ссылкой на пакет, в который он "вложен".

  ::: warning <span class="iconify" data-icon="emojione-v1:warning" style="color: #e7c000; font-size: 24px;"></span>

  Массив пакетов может быть [сформирован][5] только в [SQL yзле][6] с помощью агрегатной функции `json_agg(json_build_object())`. Вложенные пакеты должны иметь одинаковую структуру.

  Пакет с таким типом переменной не может быть снова подан на вход другого SQL узла.

  Для исполнительного скрипта в [расчетном узле][7] пакет с переменой типа "массивом пакетов" загружается как набор из основного пакета и вложенных пакетов в виде отдельных обычных пакетов.
  :::

- Уникальный идентификатор - автоматически генерируемое значение в формате [SHA256][12].
  ::: tip <span class='iconify' data-icon='mdi:information' style='color: #42b983; font-size: 24px;'></span>
  Значение идентификатора зависит от состава пакета и от истории его создания. Значение является уникальным и гарантирует неизменность пакета.
  :::

  ## Обработка пакета

Пакет может обрабатываться в 3 режимах:

1. Автоматическом

   Автоматическая обработка пакета происходит в случае, если узел находится в активном [состоянии][8]. В этом случае для каждого нового входящего пакета автоматически создается [задание][9], которое отравляется на соответствующий сервер расчетов проекта.

2. [Ручном не интерактивном][10]

   Пакет отправляется на первичную или повторную обработку вручную.

3. [Ручном интерактивном][11]

   Пакет отправляется на первичную или повторную обработку интерактивную обработку вручную.

[1]: /docs/desc/nodes.md#панели-узла
[2]: /docs/desc/nodes.md#пакеты
[3]: ./project.md#слои-данных
[4]: /docs/desc/nodes.md
[5]: /docs/dev/sql.md#пример-формирования-пакета-с-переменнои-типа-массив-пакетов
[6]: /docs/desc/nodes.md#sql-узел
[7]: /docs/desc/nodes.md#расчетныи-узел
[8]: /docs/desc/nodes.md#состояние
[9]: /docs/desc/job.md
[10]: /docs/instructions/package.md#обработка-пакета
[11]: /docs/instructions/package.md#интерактивная-обработка-пакета
[12]: https://en.wikipedia.org/wiki/SHA-2
